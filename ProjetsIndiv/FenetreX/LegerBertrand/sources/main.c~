#include <SDL2/SDL.h>
#include <stdio.h>
#include <math.h>

#define NBREWINDOWS 100



int main(int argc, char **argv) {

  int i=0;
  int j;
  
  (void)argc;
  (void)argv;

  SDL_Window *windows [NBREWINDOWS*2];


  
  /* Initialisation de la SDL  + gestion de l'échec possible */
  if (SDL_Init(SDL_INIT_VIDEO) != 0) {
    SDL_Log("Error : SDL initialisation - %s\n", 
	    SDL_GetError());                // l'initialisation de la SDL a échoué 
    exit(EXIT_FAILURE);
  }


  SDL_DisplayMode current;
  SDL_GetCurrentDisplayMode(0, &current);
  int width = current.w;
  int height = current.h;


  float position_x_left=height/2; //première fenêtre côté gauche au milieu de la largeur de l'écran
  float position_y_left=0;

  float position_x_right=height/2; //première fenêtre côté droit au milieu de la largeur de l'écran
  float position_y_right=width;

  
  /*Animation 1:
   *ligne de fenêtre de la moitié de la largeur de l'écran et de longueur = 1/3 de l'écran
   *Qui se referme une fois que la dernière est placée*/
  
  while(position_y_left < width/3 && position_y_right > (2*width)/3 ){

    windows[i] = SDL_CreateWindow(
				  "left",
				  position_x_left,position_y_left,
				  70,70,
				  0
				  );

    windows[(NBREWINDOWS*2)-1-i] = SDL_CreateWindow(
				  "right",
				  position_x_right,position_y_right,
				  70,70,
				  0
				  );
    
    if(windows[i] == NULL || windows[(NBREWINDOWS*2)-1-i] == NULL){
      SDL_Log("Error : SDL window %d creation - %s\n",i,SDL_GetError());    
      SDL_Quit();
      exit(EXIT_FAILURE);
    }
    position_x_left = position_x_left + 15;
    SDL_SetWindowPosition(windows[i],position_x_left,position_y_left);

    position_x_right = position_x_right - 15;
    SDL_SetWindowPosition(windows[i],position_x_left,position_y_left);
    
    SDL_Delay(75);
    i++;
  }
  
  SDL_Delay(300);
  for (j = 0 ; j < i ; j++){
    
    SDL_DestroyWindow(windows[j]);
    SDL_Delay(75);  
  }

  windows[0] = SDL_CreateWindow(
				"left circle",
				position_x_left +20,position_y_left,
				70,70,
				0
				);

  if(windows[0] == NULL){
    SDL_Log("Erro : SDL windox %d creation - %s\n",i,SDL_GetError());    
    SDL_Quit();
    exit(EXIT_FAILURE);
  }


  
  /*Animation 2 :
   *Je fais tourner les 2 fenêtres grâce aux coordonnées du cercle trigonométrique
   *A chaque itération les fenêtres vont grandir*/

  int b;
  
  for ( b = 0 ; b <= 50 ; b++ ){ 

    windows[i] = SDL_CreateWindow(
				  "left circle",
				  position_x_left,position_y_left,
				  70,70,
				  0
				  );

    if(windows[i] == NULL){
      SDL_Log("Error : SDL window %d creation - %s\n",i,SDL_GetError());    
      SDL_Quit();
      exit(EXIT_FAILURE);
    }
    
    float pos_x = cosf(b)*50*(b/2) + position_x_left;
    float pos_y = sinf(b)*50*(b/2) + position_y_left;
    
    SDL_SetWindowPosition(windows[i],pos_x,pos_y);
    SDL_Delay(75);
  }

  SDL_Delay(3000);

  for (b =0 ; b<=50; b++){
    
    SDL_DestroyWindow(windows[i]);
    
  }

  SDL_Quit();                                // quitte la SDL

  return 0;
}
